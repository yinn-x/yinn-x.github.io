"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[228],{2228:(n,t,e)=>{e.r(t),e.d(t,{default:()=>V});var r,o,s,i,a,l,c=e(168),d=e(2791),m=e(7689),h=e(6578),g=e(9383),p=e(5009),u=e(2683),f=e(6879),b=e(1401),x=e(184);const v=u.ZP.div(r||(r=(0,c.Z)(["\n    align-items: center;\n    h3,strong {\n        color: ",";\n        text-decoration: underline 1px;\n        text-underline-offset: .4rem;\n    }\n\n    hr {\n        margin-top: 1.25rem;\n        margin-bottom: 1.25rem;\n        border: 0;\n        border-top: 2px solid ",";\n        border-radius: 2px;\n    }\n\n    svg{\n        float: right;\n        fill: ",";\n        width: 1rem;\n        padding-left: .8rem;\n\n        &:hover{\n            fill: ",";\n        }\n    }\n\n"])),f.r.colors.primary,f.r.colors.lightgrey,f.r.colors.secondary,f.r.colors.primary),j=u.ZP.img(o||(o=(0,c.Z)(["\n    margin-top: .5rem;\n    width: 2.2rem;\n    height: 2.2rem;\n    border-radius: 50%;\n    /* border: 1px solid rgba(31,35,40,0.15); */\n    padding: .125rem;\n    vertical-align: middle;\n    margin-right: .8rem;\n\n    @media (max-width: 850px) {\n        margin-right: .6rem;\n    }\n"]))),y=u.ZP.div(s||(s=(0,c.Z)(["\n    padding-bottom: .3rem;\n    padding: .25rem .125rem;\n    display: flex;\n    align-items: flex-start;  /* Align items to the start of the cross axis (top) */\n    margin: .5rem 0;\n\n    @media (max-width: 850px) {\n        padding: .25rem 0;\n    }\n"]))),Z=u.ZP.a(i||(i=(0,c.Z)(["\n    /* font-family: JetBrainsMono; */\n    font-weight: bold;\n    color: ",";\n    font-size: .95rem;\n"])),f.r.colors.tertiary),w=u.ZP.div(a||(a=(0,c.Z)(["\n    line-height: 1.6rem;\n    font-size: .925rem;\n    color: ",";\n    padding: .1rem 0;\n\n    span.mention {\n        color: ",";\n        /* font-weight: bold; */\n    }\n"])),f.r.colors.text,f.r.colors.tertiary),I=u.ZP.button(l||(l=(0,c.Z)(["\n    border: none;\n    background-color: transparent;\n    cursor: pointer;\n    margin: .6rem .8rem 0rem;\n    color: ",";\n"])),f.r.colors.primary),P=n=>{let{comments:t}=n;const[e,r]=(0,d.useState)(!1);return(0,d.useEffect)((()=>{const n=localStorage.getItem("role");n&&"Owner"===n&&r(!0)}),[]),(0,x.jsxs)(v,{children:[(0,x.jsx)("hr",{}),t.map((n=>(0,x.jsxs)(y,{children:[(0,x.jsx)("a",{href:"https://github.com/".concat(n.githubName),children:(0,x.jsx)(j,{src:n.avatar,alt:""})}),(0,x.jsxs)(w,{children:[(0,x.jsxs)("div",{children:[(0,x.jsx)(Z,{target:"_blank",href:"https://github.com/".concat(n.githubName),children:n.githubName}),(0,x.jsx)(b.LK,{children:n.time.split(" ")[0]})]}),(0,x.jsx)("div",{children:n.content.split(/(@\S+)/g).map(((n,t)=>n.startsWith("@")?(0,x.jsx)("span",{className:"mention",children:n},t):n))})]})]},n.id)))]})};var k,S,$=e(4376);function E(){return E=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},E.apply(this,arguments)}function C(n,t){let{title:e,titleId:r,...o}=n;return d.createElement("svg",E({t:1699517890106,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":4998,width:48,height:48,ref:t,"aria-labelledby":r},o),e?d.createElement("title",{id:r},e):null,k||(k=d.createElement("path",{d:"M507.904 882.688c-18.432 0-33.28-14.848-33.28-33.28v-655.36c0-18.432 14.848-33.28 33.28-33.28s33.28 14.848 33.28 33.28v654.848c0 18.432-14.848 33.792-33.28 33.792z",fill:"","p-id":4999})),S||(S=d.createElement("path",{d:"M787.968 502.784c-8.704 0-16.896-3.072-23.552-9.728L507.904 236.544 251.392 493.056c-12.8 12.8-34.304 12.8-47.104 0-12.8-12.8-12.8-34.304 0-47.104l280.064-280.064c6.144-6.144 14.848-9.728 23.552-9.728s17.408 3.584 23.552 9.728l280.064 280.064c12.8 12.8 12.8 34.304 0 47.104-6.656 6.656-15.36 9.728-23.552 9.728z","p-id":5e3})))}const O=d.forwardRef(C);e.p;var z,M,N,B,_=e(8604);const q=(0,g.ZP)(z||(z=(0,c.Z)(["\n  mutation Comment($content: String!, $post_id: Int!) {\n    comment(content: $content, post_id: $post_id) \n  }\n"]))),L=u.ZP.form(M||(M=(0,c.Z)(["\n  margin: 2rem 0;\n"]))),U=u.ZP.textarea(N||(N=(0,c.Z)(["\n  padding: 0.625rem;\n  margin-bottom: 0.625rem;\n  border: 0;\n  border-radius: 1rem;\n  background-color: ",";\n  width: 85%;\n  height: 7rem;\n  padding: 1rem 1.5rem;\n  resize: none;\n  font-size: 0.9rem;\n\n  &:focus {\n    outline: none;\n  }\n"])),f.r.colors.block),A=u.ZP.button(B||(B=(0,c.Z)(["\n  float: right;\n  background-color: transparent;\n  border: none;\n  cursor: pointer;\n\n  svg {\n    fill: ",";\n    width: 1.75rem;\n  }\n\n  &:hover {\n    & svg {\n      fill: ",";\n    }\n  }\n"])),f.r.colors.secondary,f.r.colors.primary),D=()=>{const{id:n}=(0,m.UO)(),[t,e]=(0,d.useState)(""),[r,{error:o}]=(0,$.D)(q,{onCompleted:()=>{window.location.reload()},onError:n=>{console.error("Mutation error:",n.message)},context:{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}});return(0,x.jsxs)(L,{onSubmit:e=>{e.preventDefault(),""!==t.trim()&&null!=n&&r({variables:{content:t,post_id:parseInt(n)}})},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)(U,{placeholder:localStorage.getItem("token")?"Write your comment":"Please sign in first",value:t,onChange:n=>{e(n.target.value)}}),(0,x.jsx)(A,{type:"submit",children:(0,x.jsx)(O,{})})]}),o&&(0,x.jsxs)(_.B,{children:["Error: ",o.message]})]})};var R,W=e(2241);const G=(0,g.ZP)(R||(R=(0,c.Z)(["\n  query Comments($postId: Int!, $limit: Int!, $offset: Int!) {\n    comments(\n      filters: { postId: { eq: $postId }, status: { eq: PUBLIC } }\n      orderBy: { time: ASC }\n      pagination: { offset: { limit: $limit, offset: $offset } }\n    ) {\n      nodes {\n        id\n        parentId\n        githubName\n        time\n        content\n      }\n    }\n  }\n"]))),H=async function(n){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;try{const t=await fetch("https://api.github.com/users/".concat(n));return(await t.json()).avatar_url}catch(e){return console.error("Error fetching user data:",e),t>1?H(n,t-1):""}},J=()=>{var n;const{id:t=""}=(0,m.UO)(),[e,r]=(0,d.useState)(!1),[o,s]=(0,d.useState)([]),[i,a]=(0,d.useState)(!1),{data:l,loading:c,fetchMore:g}=(0,h.a)(G,{variables:{postId:parseInt(t,10),limit:10,offset:0},fetchPolicy:"cache-and-network"}),p=(null===l||void 0===l||null===(n=l.comments)||void 0===n?void 0:n.nodes)||[],u=p.length>=10;(0,d.useEffect)((()=>{(async()=>{const n=p.map((n=>H(n.githubName)));try{const t=await Promise.all(n);s(t),a(!0)}catch(t){console.error("Error fetching avatars:",t)}})()}),[p]);const f=p.map(((n,t)=>({...n,avatar:o[t]||""})));return(0,x.jsxs)(W.GU,{children:[i?(0,x.jsx)(P,{comments:f}):(0,x.jsx)(I,{children:"Loading Avatars..."}),!c&&u&&!e&&(0,x.jsx)(I,{onClick:()=>{g({variables:{offset:p.length},updateQuery:(n,t)=>{let{fetchMoreResult:e}=t;if(!e)return n;const o=e.comments.nodes;return o.length<10&&r(!0),{comments:{nodes:n.comments.nodes.concat(o)}}}})},children:"Load More"}),!c&&(0,x.jsx)(D,{})]})};var K,Q=e(5605);const F=(0,g.ZP)(K||(K=(0,c.Z)(["\n  query Posts($postId: Int!) {\n    posts(filters: { id: { eq: $postId } }) {\n      nodes {\n        id\n        title\n        time\n        content\n        status\n        tags {\n          nodes {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))),T=[{label:"Home",to:"/"},{label:"Posts",to:"/"},{label:"Detail",to:"/post/:id"}],V=()=>{const{id:n}=(0,m.UO)(),t=parseInt(n||"",10),{loading:e,error:r,data:o}=(0,h.a)(F,{variables:{postId:t}});if(e)return(0,x.jsx)("br",{});if(r||!o||!o.posts||!o.posts.nodes.length)return(0,x.jsx)("code",{children:"Post not found."});const s=o.posts.nodes[0];return(0,x.jsxs)(W.b6,{children:[(0,x.jsx)(Q.Z,{items:T}),(0,x.jsx)(p.Z,{title:s.title,id:parseInt(s.id),content:s.content,time:s.time,tags:s.tags.nodes.map((n=>n.name))}),(0,x.jsx)(J,{})]})}}}]);
//# sourceMappingURL=228.0576e458.chunk.js.map